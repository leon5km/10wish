[ 2014-08-18T15:23:15+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.023001s ]
INFO: [ route_check ] --END-- [ RunTime:0.105006s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.024002s ]
INFO: [ app_begin ] --END-- [ RunTime:0.040002s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:0.242014s ]
INFO: [ view_parse ] --END-- [ RunTime:0.259014s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.025001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.027002s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.011001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.044002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.149009s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.023002s ]
INFO: [ view_end ] --END-- [ RunTime:0.039002s ]

[ 2014-08-18T15:23:45+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-03&date_end=2014-08-09
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.018001s ]
INFO: [ route_check ] --END-- [ RunTime:0.030002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.032002s ]
INFO: [ app_begin ] --END-- [ RunTime:0.043003s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-03 00:00:00" AND lo.login_time<"2014-08-09 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:1.108063s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-03 00:00:00"    AND n.publish_time<"2014-08-09 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.046003s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-03 00:00:00" AND  t.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-03 00:00:00" AND  t.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-03 00:00:00" AND  t.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.123007s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-03 00:00:00" AND w.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-03 00:00:00" AND w.create_time<"2014-08-09 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-03 00:00:00" AND w.create_time<"2014-08-09 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-03 00:00:00" AND w.create_time<"2014-08-09 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.250014s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-03 00:00:00" AND i.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-03 00:00:00" AND uc.create_time<"2014-08-09 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-03 00:00:00" AND uc.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.170010s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:7.747443s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-03 00:00:00" AND w.create_time<"2014-08-09 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-03 00:00:00" AND lo.login_time<"2014-08-09 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.111063s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-03 00:00:00" AND w.create_time<"2014-08-09 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-03 00:00:00" AND lo.login_time<"2014-08-09 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.061061s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-03 00:00:00" AND w.create_time<"2014-08-09 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-03 00:00:00" AND lo.login_time<"2014-08-09 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.964055s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-03 00:00:00" AND w.create_time<"2014-08-09 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-03 00:00:00" AND lo.login_time<"2014-08-09 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.027059s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-03 00:00:00" AND w.create_time<"2014-08-09 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-03 00:00:00" AND lo.login_time<"2014-08-09 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.019058s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-03 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.188010s ]
SQL: 
				CALL count_worklog_all("2014-08-03 00:00:00","2014-08-09 00:00:00",("28422"))
				 [ RunTime:0.297017s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.721099s ]
INFO: [ view_parse ] --END-- [ RunTime:1.733099s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.014001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.024001s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.008001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.031002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.104006s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.017001s ]
INFO: [ view_end ] --END-- [ RunTime:0.027002s ]

[ 2014-08-18T15:30:42+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/zhoubao
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.019001s ]
INFO: [ route_check ] --END-- [ RunTime:0.032002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.025001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.045002s ]
INFO: [ view_parse ] --START--
NOTIC: [8] Undefined variable: data1 D:\Dropbox-List\Net\Dropbox\WebDev\xampp\htdocs\php_demo\shizhan\10\10wish\APP\Runtime\Cache\Njb\7ba99407204f262109d17dccd112493a.php 第 19 行.
INFO: ParseTemplate Behavior ::run [ RunTime:0.458026s ]
INFO: [ view_parse ] --END-- [ RunTime:0.483028s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.066004s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.045003s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.024002s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.032001s ]
INFO: [ view_filter ] --END-- [ RunTime:0.217013s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.035002s ]
INFO: [ view_end ] --END-- [ RunTime:0.046002s ]

[ 2014-08-18T15:31:32+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/zhoubao
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.013000s ]
INFO: [ route_check ] --END-- [ RunTime:0.028002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.024002s ]
INFO: [ app_begin ] --END-- [ RunTime:0.037002s ]
INFO: [ view_parse ] --START--
NOTIC: [8] Undefined variable: data1 D:\Dropbox-List\Net\Dropbox\WebDev\xampp\htdocs\php_demo\shizhan\10\10wish\APP\Runtime\Cache\Njb\7ba99407204f262109d17dccd112493a.php 第 19 行.
INFO: ParseTemplate Behavior ::run [ RunTime:0.298017s ]
INFO: [ view_parse ] --END-- [ RunTime:0.311018s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.013000s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.017001s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.008000s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.019001s ]
INFO: [ view_filter ] --END-- [ RunTime:0.083005s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.020001s ]
INFO: [ view_end ] --END-- [ RunTime:0.032001s ]

[ 2014-08-18T15:47:03+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/zhoubao
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.018001s ]
INFO: [ route_check ] --END-- [ RunTime:0.029002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.030002s ]
INFO: [ app_begin ] --END-- [ RunTime:0.045002s ]
INFO: [ view_parse ] --START--
NOTIC: [8] Undefined variable: data1 D:\Dropbox-List\Net\Dropbox\WebDev\xampp\htdocs\php_demo\shizhan\10\10wish\APP\Runtime\Cache\Njb\7ba99407204f262109d17dccd112493a.php 第 19 行.
INFO: ParseTemplate Behavior ::run [ RunTime:0.270016s ]
INFO: [ view_parse ] --END-- [ RunTime:0.283016s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.019001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.032002s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.015001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.035002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.151009s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.032002s ]
INFO: [ view_end ] --END-- [ RunTime:0.049002s ]

[ 2014-08-18T16:11:43+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/html
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.016001s ]
INFO: [ route_check ] --END-- [ RunTime:0.026001s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.020001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.031001s ]
ERR: 非法操作:html

[ 2014-08-18T16:11:55+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.014000s ]
INFO: [ route_check ] --END-- [ RunTime:0.028002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.030002s ]
INFO: [ app_begin ] --END-- [ RunTime:0.043002s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:0.253015s ]
INFO: [ view_parse ] --END-- [ RunTime:0.265015s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.047003s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.025002s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.026002s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.039002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.180010s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.023002s ]
INFO: [ view_end ] --END-- [ RunTime:0.040002s ]

[ 2014-08-18T16:16:05+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-04&date_end=2014-08-05
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.016001s ]
INFO: [ route_check ] --END-- [ RunTime:0.033002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.017001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.030001s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.082004s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-04 00:00:00"    AND n.publish_time<"2014-08-05 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.006000s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.015001s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.020001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-04 00:00:00" AND i.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-04 00:00:00" AND uc.create_time<"2014-08-05 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-04 00:00:00" AND uc.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.012001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:6.711384s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.892051s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.858049s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.840048s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.851049s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.809046s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-04 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.136008s ]
SQL: 
				CALL count_worklog_all("2014-08-04 00:00:00","2014-08-05 00:00:00",("28422"))
				 [ RunTime:0.055004s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.117064s ]
INFO: [ view_parse ] --END-- [ RunTime:1.126064s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.034002s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.039002s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.019001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.049002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.193011s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.020001s ]
INFO: [ view_end ] --END-- [ RunTime:0.031002s ]

[ 2014-08-18T16:19:24+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-04&date_end=2014-08-05
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.013000s ]
INFO: [ route_check ] --END-- [ RunTime:0.024002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.019001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.030002s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.049003s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-04 00:00:00"    AND n.publish_time<"2014-08-05 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.006000s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.012001s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.015001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-04 00:00:00" AND i.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-04 00:00:00" AND uc.create_time<"2014-08-05 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-04 00:00:00" AND uc.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.010000s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:6.402366s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.988056s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.757043s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.758043s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.869050s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.821047s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-04 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.140008s ]
SQL: 
				CALL count_worklog_all("2014-08-04 00:00:00","2014-08-05 00:00:00",("28422"))
				 [ RunTime:0.021001s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.193068s ]
INFO: [ view_parse ] --END-- [ RunTime:1.204069s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.017001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.014001s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.007001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.020001s ]
INFO: [ view_filter ] --END-- [ RunTime:0.079004s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.013001s ]
INFO: [ view_end ] --END-- [ RunTime:0.020001s ]

[ 2014-08-18T16:26:17+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/zhoubao
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.015001s ]
INFO: [ route_check ] --END-- [ RunTime:0.028002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.020001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.030002s ]
INFO: [ view_parse ] --START--
NOTIC: [8] Undefined variable: data1 D:\Dropbox-List\Net\Dropbox\WebDev\xampp\htdocs\php_demo\shizhan\10\10wish\APP\Runtime\Cache\Njb\7ba99407204f262109d17dccd112493a.php 第 19 行.
INFO: ParseTemplate Behavior ::run [ RunTime:0.283017s ]
INFO: [ view_parse ] --END-- [ RunTime:0.294017s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.024001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.034002s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.016001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.039002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.158009s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.018001s ]
INFO: [ view_end ] --END-- [ RunTime:0.028002s ]

[ 2014-08-18T16:28:20+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-05&date_end=2014-08-06
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.016001s ]
INFO: [ route_check ] --END-- [ RunTime:0.032002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.019001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.030002s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.050003s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-05 00:00:00"    AND n.publish_time<"2014-08-06 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.005000s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-05 00:00:00" AND  t.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-05 00:00:00" AND  t.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-05 00:00:00" AND  t.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.010000s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.021001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-05 00:00:00" AND i.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-05 00:00:00" AND uc.create_time<"2014-08-06 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-05 00:00:00" AND uc.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.016001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:6.590377s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.997057s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.998058s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.035059s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.075061s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.896051s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-05 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.148008s ]
SQL: 
				CALL count_worklog_all("2014-08-05 00:00:00","2014-08-06 00:00:00",("28422"))
				 [ RunTime:0.024001s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.255072s ]
INFO: [ view_parse ] --END-- [ RunTime:1.265072s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.016000s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.017001s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.007000s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.022001s ]
INFO: [ view_filter ] --END-- [ RunTime:0.085005s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.061004s ]
INFO: [ view_end ] --END-- [ RunTime:0.072004s ]

[ 2014-08-18T16:28:57+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-04&date_end=2014-08-05
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.015001s ]
INFO: [ route_check ] --END-- [ RunTime:0.027002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.025001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.035002s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.045002s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-04 00:00:00"    AND n.publish_time<"2014-08-05 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.005001s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.010000s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.018001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-04 00:00:00" AND i.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-04 00:00:00" AND uc.create_time<"2014-08-05 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-04 00:00:00" AND uc.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.016001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:6.238357s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.845049s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.851048s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.832048s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.836048s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.832048s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-04 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.159009s ]
SQL: 
				CALL count_worklog_all("2014-08-04 00:00:00","2014-08-05 00:00:00",("28422"))
				 [ RunTime:0.024001s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.257072s ]
INFO: [ view_parse ] --END-- [ RunTime:1.265073s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.022002s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.023001s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.013000s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.038002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.129007s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.023001s ]
INFO: [ view_end ] --END-- [ RunTime:0.037002s ]

[ 2014-08-18T16:29:36+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-05&date_end=2014-08-06
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.014001s ]
INFO: [ route_check ] --END-- [ RunTime:0.023001s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.029001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.043003s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.077005s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-05 00:00:00"    AND n.publish_time<"2014-08-06 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.022001s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-05 00:00:00" AND  t.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-05 00:00:00" AND  t.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-05 00:00:00" AND  t.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.019001s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.023001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-05 00:00:00" AND i.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-05 00:00:00" AND uc.create_time<"2014-08-06 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-05 00:00:00" AND uc.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.012001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:5.776330s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.083062s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.994057s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.959055s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.010058s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.077062s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-05 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.170009s ]
SQL: 
				CALL count_worklog_all("2014-08-05 00:00:00","2014-08-06 00:00:00",("28422"))
				 [ RunTime:0.026002s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.502086s ]
INFO: [ view_parse ] --END-- [ RunTime:1.516087s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.026002s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.025002s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.013001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.036002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.145008s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.060004s ]
INFO: [ view_end ] --END-- [ RunTime:0.074004s ]

[ 2014-08-18T16:30:08+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-07&date_end=2014-08-08
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.012000s ]
INFO: [ route_check ] --END-- [ RunTime:0.024002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.024001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.037002s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.047003s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-07 00:00:00"    AND n.publish_time<"2014-08-08 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.006000s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-07 00:00:00" AND  t.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-07 00:00:00" AND  t.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-07 00:00:00" AND  t.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.009001s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.018001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-07 00:00:00" AND i.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-07 00:00:00" AND uc.create_time<"2014-08-08 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-07 00:00:00" AND uc.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.010001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:5.685325s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.821047s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.873050s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.841048s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.847049s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.787045s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-07 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.109006s ]
SQL: 
				CALL count_worklog_all("2014-08-07 00:00:00","2014-08-08 00:00:00",("28422"))
				 [ RunTime:0.020001s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.059061s ]
INFO: [ view_parse ] --END-- [ RunTime:1.066061s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.014001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.014001s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.006001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.031002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.087005s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.019001s ]
INFO: [ view_end ] --END-- [ RunTime:0.026001s ]

[ 2014-08-18T16:30:32+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-08&date_end=2014-08-09
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.021001s ]
INFO: [ route_check ] --END-- [ RunTime:0.034002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.024002s ]
INFO: [ app_begin ] --END-- [ RunTime:0.036002s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-08 00:00:00" AND lo.login_time<"2014-08-09 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.061004s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-08 00:00:00"    AND n.publish_time<"2014-08-09 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.005000s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-08 00:00:00" AND  t.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-08 00:00:00" AND  t.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-08 00:00:00" AND  t.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.012001s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-08 00:00:00" AND w.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-08 00:00:00" AND w.create_time<"2014-08-09 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-08 00:00:00" AND w.create_time<"2014-08-09 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-08 00:00:00" AND w.create_time<"2014-08-09 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.020001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-08 00:00:00" AND i.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-08 00:00:00" AND uc.create_time<"2014-08-09 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-08 00:00:00" AND uc.create_time<"2014-08-09 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.010001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:5.465312s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-08 00:00:00" AND w.create_time<"2014-08-09 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-08 00:00:00" AND lo.login_time<"2014-08-09 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.762044s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-08 00:00:00" AND w.create_time<"2014-08-09 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-08 00:00:00" AND lo.login_time<"2014-08-09 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.762043s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-08 00:00:00" AND w.create_time<"2014-08-09 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-08 00:00:00" AND lo.login_time<"2014-08-09 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.749043s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-08 00:00:00" AND w.create_time<"2014-08-09 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-08 00:00:00" AND lo.login_time<"2014-08-09 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.759044s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-08 00:00:00" AND w.create_time<"2014-08-09 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-08 00:00:00" AND lo.login_time<"2014-08-09 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.738043s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-08 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.101006s ]
SQL: 
				CALL count_worklog_all("2014-08-08 00:00:00","2014-08-09 00:00:00",("28422"))
				 [ RunTime:0.019001s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.096063s ]
INFO: [ view_parse ] --END-- [ RunTime:1.104063s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.017001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.025001s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.011001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.036002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.123007s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.012000s ]
INFO: [ view_end ] --END-- [ RunTime:0.020001s ]

[ 2014-08-18T16:35:18+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-06&date_end=2014-08-07
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.014001s ]
INFO: [ route_check ] --END-- [ RunTime:0.026001s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.017001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.029002s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.051003s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-06 00:00:00"    AND n.publish_time<"2014-08-07 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.006000s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-06 00:00:00" AND  t.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-06 00:00:00" AND  t.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-06 00:00:00" AND  t.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.012001s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.020001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-06 00:00:00" AND i.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-06 00:00:00" AND uc.create_time<"2014-08-07 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-06 00:00:00" AND uc.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.010001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:5.767329s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.898052s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.862049s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.838048s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.738042s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.748043s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-06 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.121007s ]
SQL: 
				CALL count_worklog_all("2014-08-06 00:00:00","2014-08-07 00:00:00",("28422"))
				 [ RunTime:0.020002s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.093063s ]
INFO: [ view_parse ] --END-- [ RunTime:1.102063s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.011001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.028002s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.006000s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.018001s ]
INFO: [ view_filter ] --END-- [ RunTime:0.095005s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.050003s ]
INFO: [ view_end ] --END-- [ RunTime:0.119007s ]

[ 2014-08-18T16:42:34+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/zhoubao?date_begin=&date_end=
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.018001s ]
INFO: [ route_check ] --END-- [ RunTime:0.031001s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.023001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.035002s ]
INFO: [ view_parse ] --START--
NOTIC: [8] Undefined variable: data1 D:\Dropbox-List\Net\Dropbox\WebDev\xampp\htdocs\php_demo\shizhan\10\10wish\APP\Runtime\Cache\Njb\7ba99407204f262109d17dccd112493a.php 第 19 行.
INFO: ParseTemplate Behavior ::run [ RunTime:0.260015s ]
INFO: [ view_parse ] --END-- [ RunTime:0.270015s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.018001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.033002s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.014001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.027001s ]
INFO: [ view_filter ] --END-- [ RunTime:0.145008s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.021002s ]
INFO: [ view_end ] --END-- [ RunTime:0.035002s ]

[ 2014-08-18T16:42:53+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-07&date_end=2014-08-08
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.011000s ]
INFO: [ route_check ] --END-- [ RunTime:0.019002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.018001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.026001s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.035002s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-07 00:00:00"    AND n.publish_time<"2014-08-08 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.005000s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-07 00:00:00" AND  t.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-07 00:00:00" AND  t.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-07 00:00:00" AND  t.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.008001s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.022001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-07 00:00:00" AND i.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-07 00:00:00" AND uc.create_time<"2014-08-08 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-07 00:00:00" AND uc.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.014001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:6.275359s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.214069s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.202069s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.191068s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.237071s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.110063s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-07 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.157009s ]
SQL: 
				CALL count_worklog_all("2014-08-07 00:00:00","2014-08-08 00:00:00",("28422"))
				 [ RunTime:0.038002s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.287074s ]
INFO: [ view_parse ] --END-- [ RunTime:1.298074s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.021001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.020001s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.008000s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.020001s ]
INFO: [ view_filter ] --END-- [ RunTime:0.096005s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.084005s ]
INFO: [ view_end ] --END-- [ RunTime:0.094005s ]

[ 2014-08-18T16:44:52+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/html
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.026001s ]
INFO: [ route_check ] --END-- [ RunTime:0.047003s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.026002s ]
INFO: [ app_begin ] --END-- [ RunTime:0.038002s ]
ERR: 非法操作:html

[ 2014-08-18T16:58:47+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-04&date_end=2014-08-05
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.012001s ]
INFO: [ route_check ] --END-- [ RunTime:0.024002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.019001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.033002s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.048003s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-04 00:00:00"    AND n.publish_time<"2014-08-05 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.006000s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-04 00:00:00" AND  t.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.009001s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.018001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-04 00:00:00" AND i.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-04 00:00:00" AND uc.create_time<"2014-08-05 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-04 00:00:00" AND uc.create_time<"2014-08-05 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.011001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:6.559375s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.824047s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.742043s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.734042s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.778044s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-04 00:00:00" AND w.create_time<"2014-08-05 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-04 00:00:00" AND lo.login_time<"2014-08-05 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.764044s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-04 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.147009s ]
SQL: 
				CALL count_worklog_all("2014-08-04 00:00:00","2014-08-05 00:00:00",("28422"))
				 [ RunTime:0.018001s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.162066s ]
INFO: [ view_parse ] --END-- [ RunTime:1.169067s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.011001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.031002s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.011000s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.036002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.126007s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.020001s ]
INFO: [ view_end ] --END-- [ RunTime:0.081005s ]

[ 2014-08-18T16:59:53+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-06&date_end=2014-08-07
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.012001s ]
INFO: [ route_check ] --END-- [ RunTime:0.023001s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.018001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.027002s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.047002s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-06 00:00:00"    AND n.publish_time<"2014-08-07 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.005001s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-06 00:00:00" AND  t.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-06 00:00:00" AND  t.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-06 00:00:00" AND  t.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.011000s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.019001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-06 00:00:00" AND i.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-06 00:00:00" AND uc.create_time<"2014-08-07 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-06 00:00:00" AND uc.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.011001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:5.481313s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.582033s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.588034s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.550031s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.578033s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.597035s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-06 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.100006s ]
SQL: 
				CALL count_worklog_all("2014-08-06 00:00:00","2014-08-07 00:00:00",("28422"))
				 [ RunTime:0.019001s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:0.823047s ]
INFO: [ view_parse ] --END-- [ RunTime:0.829047s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.008000s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.010000s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.005001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.017001s ]
INFO: [ view_filter ] --END-- [ RunTime:0.096005s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.011000s ]
INFO: [ view_end ] --END-- [ RunTime:0.017001s ]

[ 2014-08-18T17:00:37+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-05&date_end=2014-08-06
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.018001s ]
INFO: [ route_check ] --END-- [ RunTime:0.031001s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.017001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.027001s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.050003s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-05 00:00:00"    AND n.publish_time<"2014-08-06 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.007000s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-05 00:00:00" AND  t.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-05 00:00:00" AND  t.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-05 00:00:00" AND  t.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.008001s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.018001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-05 00:00:00" AND i.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-05 00:00:00" AND uc.create_time<"2014-08-06 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-05 00:00:00" AND uc.create_time<"2014-08-06 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.011000s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:6.125350s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.807046s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.732042s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.654037s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.655038s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-05 00:00:00" AND w.create_time<"2014-08-06 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-05 00:00:00" AND lo.login_time<"2014-08-06 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:1.100063s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-05 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.175010s ]
SQL: 
				CALL count_worklog_all("2014-08-05 00:00:00","2014-08-06 00:00:00",("28422"))
				 [ RunTime:0.027002s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.310075s ]
INFO: [ view_parse ] --END-- [ RunTime:1.320075s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.018001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.028002s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.010001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.032002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.125008s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.075004s ]
INFO: [ view_end ] --END-- [ RunTime:0.092006s ]

[ 2014-08-18T17:02:05+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-06&date_end=2014-08-07
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.016001s ]
INFO: [ route_check ] --END-- [ RunTime:0.026001s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.026002s ]
INFO: [ app_begin ] --END-- [ RunTime:0.038002s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.054003s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-06 00:00:00"    AND n.publish_time<"2014-08-07 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.005000s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-06 00:00:00" AND  t.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-06 00:00:00" AND  t.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-06 00:00:00" AND  t.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.009001s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.018001s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-06 00:00:00" AND i.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-06 00:00:00" AND uc.create_time<"2014-08-07 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-06 00:00:00" AND uc.create_time<"2014-08-07 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.011001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:5.666324s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.890051s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.858049s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.844048s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.867050s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-06 00:00:00" AND w.create_time<"2014-08-07 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-06 00:00:00" AND lo.login_time<"2014-08-07 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.878050s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-06 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.135008s ]
SQL: 
				CALL count_worklog_all("2014-08-06 00:00:00","2014-08-07 00:00:00",("28422"))
				 [ RunTime:0.023001s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.248071s ]
INFO: [ view_parse ] --END-- [ RunTime:1.258072s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.018001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.040003s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.013001s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.037002s ]
INFO: [ view_filter ] --END-- [ RunTime:0.141008s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.067003s ]
INFO: [ view_end ] --END-- [ RunTime:0.081005s ]

[ 2014-08-18T17:02:58+08:00 ] 127.0.0.1 /php_demo/shizhan/10/10wish/index.php/Njb/Index/tongji?checkbox%5B%5D=28422&date_begin=2014-08-07&date_end=2014-08-08
INFO: [ route_check ] --START--
INFO: CheckRoute Behavior ::run [ RunTime:0.018001s ]
INFO: [ route_check ] --END-- [ RunTime:0.028002s ]
INFO: [ app_begin ] --START--
INFO: ReadHtmlCache Behavior ::run [ RunTime:0.019002s ]
INFO: [ app_begin ] --END-- [ RunTime:0.029002s ]
SQL: SELECT l.name,COALESCE(a.ucount,0) as yhs,COALESCE(c.ulcount,0) as dlyhs,COALESCE(c.logCount,0) as dlcs FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(ud.id) ucount FROM   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud     GROUP BY ud.locid  ) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00"   GROUP BY ud.locid) c ON l.id=c.locid WHERE l.id IN(28422) [ RunTime:0.077005s ]
SQL: SELECT l.name,COALESCE(a.noticeCount,0) noticeCount,COALESCE(a.userCount,0) userCount FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(n.id) noticeCount,COUNT(DISTINCT ud.id) userCount FROM notice n,   (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)    UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE n.owner_id=ud.id AND n.publish_time>="2014-08-07 00:00:00"    AND n.publish_time<"2014-08-08 00:00:00" GROUP BY ud.locid) a  ON l.id=a.locid WHERE l.id IN(28422) [ RunTime:0.005001s ]
SQL: SELECT l.name,COALESCE(a.asCount,0) a,COALESCE(b.adminCount,0) b,COALESCE(c.noAdminCount,0) c FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(t.id) asCount FROM assignment t,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND t.create_time>="2014-08-07 00:00:00" AND  t.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid  LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) adminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud   WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='TechAdmin'   AND t.create_time>="2014-08-07 00:00:00" AND  t.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) noAdminCount FROM assignment t,app_user_role r,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE t.creator_id=ud.id AND ud.id=r.user_id AND r.role='Technician'   AND t.create_time>="2014-08-07 00:00:00" AND  t.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid ) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.013001s ]
SQL: SELECT l.name,COALESCE(a.worklogCount,0) a,COALESCE(a.uCount,0) b,COALESCE(b.docCount,0) c,COALESCE(c.phoCount,0) d,COALESCE(d.audioCount,0) e FROM location l LEFT JOIN  (SELECT ud.locid locid,COUNT(DISTINCT w.id) worklogCount,COUNT(DISTINCT w.owner_id) uCount FROM work_log w,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id    AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) docCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  AND i.media_type=1   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) phoCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  AND i.media_type=2   GROUP BY ud.locid ) c ON l.id=c.locid LEFT JOIN  (SELECT ud.locid locid,i.media_type,COUNT(i.id) audioCount FROM work_log w,work_log_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE w.owner_id=ud.id AND w.id=i.work_log_id   AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00"  AND i.media_type=3   GROUP BY ud.locid ) d ON l.id=d.locid   WHERE l.id IN(28422) [ RunTime:0.029002s ]
SQL: SELECT l.name,COALESCE(a.photoCount,0) a,COALESCE(a.ucount,0) b,COALESCE(b.priseCount,0) c,COALESCE(c.comCount,0) d FROM location l LEFT JOIN (SELECT ud.locid locid,COUNT(i.id) photoCount,COUNT(DISTINCT ud.id) ucount FROM album m,album_item i,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE m.owner_id=ud.id AND i.album_id=m.id   AND i.create_time>="2014-08-07 00:00:00" AND i.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) a ON l.id=a.locid LEFT JOIN  (SELECT ud.locid locid,COUNT(uc.id) priseCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='AlbumItem'   AND uc.create_time>"2014-08-07 00:00:00" AND uc.create_time<"2014-08-08 00:00:00"   GROUP BY ud.locid ) b ON l.id=b.locid LEFT JOIN (SELECT ud.locid locid,COUNT(uc.id) comCount FROM user_comment uc,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)  UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE ud.id=uc.creator_id AND uc.obj_type='SystemComment'   AND uc.create_time>="2014-08-07 00:00:00" AND uc.create_time<"2014-08-08 00:00:00"  GROUP BY ud.locid) c ON l.id=c.locid  WHERE l.id IN(28422) [ RunTime:0.018001s ]
SQL: SELECT a.rname a,l.name b,d.name c,a.age d FROM (SELECT u.id uid,u.real_name rname,u.location_id locid,u.dept_id depId,(2014-(SELECT SUBSTR(u.identify_value,7,4))+0) age FROM app_user u WHERE NOT EXISTS ( SELECT lo.user_id FROM login_log lo WHERE u.id=lo.user_id  ) AND u.id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id FROM app_user u WHERE u.location_id IN(28422) )) a,location l,department d WHERE a.depId=d.id AND a.locid=l.id [ RunTime:5.865335s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.886051s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24561 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24561 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.984056s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24521 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24521 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.747043s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =24543 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =24543 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.776045s ]
SQL: SELECT u.id,u.real_name,COALESCE(a.worklogCount,0) worklogCount,COALESCE(b.logCount,0) logCount FROM app_user u LEFT JOIN (SELECT w.owner_id uid,COALESCE(COUNT(w.id)) worklogCount FROM work_log w WHERE w.owner_id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND w.create_time>="2014-08-07 00:00:00" AND w.create_time<"2014-08-08 00:00:00" GROUP BY w.owner_id) a ON u.id=a.uid LEFT JOIN (SELECT lo.user_id uid,COUNT(lo.user_id) logCount FROM login_log lo WHERE lo.user_id IN( SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) AND lo.login_time>="2014-08-07 00:00:00" AND lo.login_time<"2014-08-08 00:00:00" GROUP BY lo.user_id ) b ON u.id=b.uid WHERE u.id IN(SELECT u.id FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id =28422 UNION ALL SELECT u.id FROM app_user u WHERE u.location_id =28422 ) ORDER BY a.worklogCount DESC,b.logCount DESC LIMIT 10 [ RunTime:0.793045s ]
SQL: SELECT l.name,COALESCE(a.ulcount,0) b FROM  location l LEFT JOIN (SELECT ud.locid locid,COUNT(DISTINCT ud.id) ulcount,COUNT(ud.id) logCount FROM login_log lo,  (SELECT u.id,f.ancestor_id locid FROM app_user u,location_flat f WHERE u.location_id=f.location_id AND f.ancestor_id IN(28422)   UNION ALL SELECT u.id,u.location_id locid FROM app_user u WHERE u.location_id IN(28422)) ud  WHERE lo.user_id=ud.id   AND lo.login_time>="2014-08-07 00:00:00"   GROUP BY ud.locid) a ON a.locid=l.id WHERE l.id IN (28422) [ RunTime:0.115007s ]
SQL: 
				CALL count_worklog_all("2014-08-07 00:00:00","2014-08-08 00:00:00",("28422"))
				 [ RunTime:0.022002s ]
INFO: [ view_parse ] --START--
INFO: ParseTemplate Behavior ::run [ RunTime:1.093062s ]
INFO: [ view_parse ] --END-- [ RunTime:1.101063s ]
INFO: [ view_filter ] --START--
INFO: ContentReplace Behavior ::run [ RunTime:0.014001s ]
INFO: TokenBuild Behavior ::run [ RunTime:0.022002s ]
INFO: WriteHtmlCache Behavior ::run [ RunTime:0.009000s ]
INFO: ShowRuntime Behavior ::run [ RunTime:0.030001s ]
INFO: [ view_filter ] --END-- [ RunTime:0.103006s ]
INFO: [ view_end ] --START--
INFO: ShowPageTrace Behavior ::run [ RunTime:0.049003s ]
INFO: [ view_end ] --END-- [ RunTime:0.118007s ]

